{% extends 'base.html' %}
{% block title %}Ecoaware Everyday Things' Site{% endblock %}
{% block javascript %}
	<script src='js/jquery.js' type='text/javascript'></script>
	<script src='js/funciones.js' type='text/javascript'></script>
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript">
			//var accEnergy = "{{ accEnergy|safe }}";
        	google.load("visualization", "1", {packages:["corechart"]});
            google.setOnLoadCallback(drawChart);
			
            function drawChart() {
			  var data = google.visualization.arrayToDataTable([
				['Fecha', 'Energía efectiva (Wh)', 'Energía no efectiva (Wh)', { role: 'annotation' } ],
				
				{% for docs in accEnergy %}
					['{{docs.date}}', parseInt('{{docs.effectiveenergy}}'), parseInt('{{docs.wastedenergy}}'), ''],
				{% endfor %}
              ]);

			  var options = {
				legend: { position: 'top', maxLines: 3 },
				bar: { groupWidth: '75%' },
				isStacked: true,
				title: 'Energía consumida cada día',
				vAxis: {title: 'Energía en Wh'},
			  };
    
            var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
            chart.draw(data, options);
          }
    </script>
{% endblock %}
{% block header %}Energía consumida{% endblock %}
{% block content %}
	<table border="0" width="100%">
    	<tr >
        	<td>
                {% if superuser %}
                <select name="days" onchange=location.href='{{domain}}/{{device}}/energychart/'+this.value>
                {% else %}
                <select name="days" onchange=location.href='{{domain}}/device/energychart/'+this.value>
                {% endif %}
                	<option value="20" disabled selected>Selecciona un rango de días</option> 
                  	<option value="5">5</option>
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                    <option value="25">25</option>
                    <option value="30">30</option>
                </select>
            </td>
        </tr>
        <tr>
        	<td>
            	<br />
                <div id="chart_div" style="width: 940px; height: 550px;" align="center"></div>
            </td>
        </tr>
    </table>
{% endblock %}
{% block login %}
	<br />
	<hr />
	<table width="100%">
    	<tr>
        	
            <td width="50%"><div align="left"><a href="{{domain}}/graphics">Volver</a></div></td>
            <td width="50%"><div align="right"><a href="{{domain}}/logout">Cerrar sesión {{user.username|upper}}</a></div></td>
        </tr>
    </table>
{% endblock %}